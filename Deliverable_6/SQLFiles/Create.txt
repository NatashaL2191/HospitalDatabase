DROP TABLE IF EXISTS APPOINTMENT CASCADE CONSTRAINTS;
DROP TABLE IF EXISTS OPERATION CASCADE CONSTRAINTS;
DROP TABLE IF EXISTS PRESCRIPTION CASCADE CONSTRAINTS;
DROP TABLE IF EXISTS PATIENT CASCADE CONSTRAINTS;
DROP TABLE IF EXISTS INVOICE CASCADE CONSTRAINTS;
DROP TABLE IF EXISTS INSUR_AGENCY CASCADE CONSTRAINTS;
DROP TABLE IF EXISTS EMPLOYEE CASCADE CONSTRAINTS;
DROP TABLE IF EXISTS POSITION CASCADE CONSTRAINTS;
DROP TABLE IF EXISTS ROOM CASCADE CONSTRAINTS;
DROP TABLE IF EXISTS DEPARTMENT CASCADE CONSTRAINTS;

CREATE TABLE DEPARTMENT (
    DEP_ID INT PRIMARY KEY,
    DEP_NAME VARCHAR2(50 CHAR) NOT NULL,
    DEP_ADDRESS VARCHAR2(100 CHAR) NOT NULL,
    DEP_FUNDS DOUBLE PRECISION CHECK (DEP_FUNDS >= 0)
);

CREATE TABLE ROOM (
    ROOM_ID INT PRIMARY KEY,
    DEP_ID INT NOT NULL,
    ROOM_STAT VARCHAR2(50 CHAR),
    ROOM_TYPE VARCHAR2(50 CHAR),
    ROOM_CAP INT CHECK (ROOM_CAP >= 1),
    FOREIGN KEY (DEP_ID) REFERENCES DEPARTMENT(DEP_ID)
);

CREATE TABLE POSITION (
    POS_ID INT PRIMARY KEY,
    DEP_ID INT NOT NULL,
    POS_NAME VARCHAR2(50 CHAR) NOT NULL,
    POS_DESCRIPT VARCHAR2(100 CHAR),
    FOREIGN KEY (DEP_ID) REFERENCES DEPARTMENT(DEP_ID)
);

CREATE TABLE EMPLOYEE (
    EMP_ID INT PRIMARY KEY,
    EMP_LNAME VARCHAR2(50 CHAR) NOT NULL,
    EMP_FNAME VARCHAR2(50 CHAR) NOT NULL,
    POS_ID INT NOT NULL,
    DEP_ID INT NOT NULL,
    EMP_HIREDATE DATE DEFAULT CURRENT_DATE,
    EMP_DOB DATE,
    EMP_PNUM VARCHAR2(15 CHAR),
    EMP_EMAIL VARCHAR2(100 CHAR),
    EMP_ADDRESS VARCHAR2(100 CHAR),
    FOREIGN KEY (POS_ID) REFERENCES POSITION(POS_ID),
    FOREIGN KEY (DEP_ID) REFERENCES DEPARTMENT(DEP_ID)
);

CREATE TABLE INSUR_AGENCY (
    INSUR_ID INT PRIMARY KEY,
    INSUR_NAME VARCHAR2(50 CHAR) NOT NULL,
    INSUR_PNUM VARCHAR2(15 CHAR),
    INSUR_EMAIL VARCHAR2(100 CHAR),
    INSUR_ADDRESS VARCHAR2(100 CHAR)
);

CREATE TABLE INVOICE (
    INV_ID INT PRIMARY KEY,
    INSUR_ID INT NOT NULL,
    INV_COST DOUBLE PRECISION CHECK (INV_COST >= 0),
    INV_DATE DATE DEFAULT CURRENT_DATE,
    FOREIGN KEY (INSUR_ID) REFERENCES INSUR_AGENCY(INSUR_ID)
);

CREATE TABLE PATIENT (
    PAT_ID INT PRIMARY KEY,
    PAT_LNAME VARCHAR2(50 CHAR) NOT NULL,
    PAT_FNAME VARCHAR2(50 CHAR) NOT NULL,
    EMP_ID INT NOT NULL,
    INSUR_ID INT,
    PAT_DOB DATE,
    PAT_PNUM VARCHAR2(15 CHAR),
    PAT_EMAIL VARCHAR2(100 CHAR),
    PAT_ADDRESS VARCHAR2(100 CHAR),
    FOREIGN KEY (EMP_ID) REFERENCES EMPLOYEE(EMP_ID),
    FOREIGN KEY (INSUR_ID) REFERENCES INSUR_AGENCY(INSUR_ID)
);

CREATE TABLE PRESCRIPTION (
    PRE_ID INT PRIMARY KEY,
    PAT_ID INT NOT NULL,
    EMP_ID INT NOT NULL,
    PRE_Name VARCHAR2(100 CHAR) NOT NULL,
    PRE_DOS_MG DOUBLE PRECISION CHECK (PRE_DOS_MG > 0),
    FOREIGN KEY (PAT_ID) REFERENCES PATIENT(PAT_ID),
    FOREIGN KEY (EMP_ID) REFERENCES EMPLOYEE(EMP_ID)
);

CREATE TABLE OPERATION (
    OP_ID INT PRIMARY KEY,
    PAT_ID INT NOT NULL,
    EMP_ID INT NOT NULL,
    ROOM_ID INT NOT NULL,
    OP_TYPE VARCHAR2(50 CHAR) NOT NULL,
    OP_STATUS VARCHAR2(50 CHAR),
    OP_DATE DATE DEFAULT CURRENT_DATE,
    FOREIGN KEY (PAT_ID) REFERENCES PATIENT(PAT_ID),
    FOREIGN KEY (EMP_ID) REFERENCES EMPLOYEE(EMP_ID),
    FOREIGN KEY (ROOM_ID) REFERENCES ROOM(ROOM_ID)
);

CREATE TABLE APPOINTMENT (
    APP_ID INT PRIMARY KEY,
    PAT_ID INT NOT NULL,
    EMP_ID INT NOT NULL,
    INV_ID INT,
    ROOM_ID INT,
    APP_REASON VARCHAR2(100 CHAR),
    APP_OUTCOME VARCHAR2(100 CHAR),
    APP_DATE DATE DEFAULT CURRENT_DATE,
    FOREIGN KEY (PAT_ID) REFERENCES PATIENT(PAT_ID),
    FOREIGN KEY (EMP_ID) REFERENCES EMPLOYEE(EMP_ID),
    FOREIGN KEY (INV_ID) REFERENCES INVOICE(INV_ID),
    FOREIGN KEY (ROOM_ID) REFERENCES ROOM(ROOM_ID)
);